# SGR Base Agent

Эта репа — базовая реализация Schema-Guided Reasoning (SGR) агента. Ниже — чек-лист для для проектирования собственных агентов поверх базовой инфраструктуры из `sgr_framework/`.

## 0. Настройте окружение

### 0.1. Создайте виртуальное окружение

Рекомендуется использовать Python 3.12:

```bash
python3.12 -m venv .venv312
source .venv312/bin/activate  # На macOS/Linux
# или
.venv312\Scripts\activate  # На Windows
```

Альтернативно можно использовать любое другое имя для окружения (например, `.venv`):

```bash
python3.12 -m venv .venv
source .venv/bin/activate
```

### 0.2. Установите зависимости

```bash
pip install -r requirements.txt
```

### 0.3. Настройте переменные окружения

Скопируйте `env.example` в `.env` и заполните обязательные переменные:

```bash
cp env.example .env
```

Отредактируйте `.env` и укажите:
- `LITELLM_API_KEY` — ваш API-ключ для LiteLLM
- `LITELLM_BASE_URL` — URL прокси (опционально, если используете кастомный прокси)
- `MODEL_NAME` — название модели (например, `gpt-4o-mini`)

**⚠️ Важно:** Файл `.env` не должен попадать в git-репозиторий (он уже добавлен в `.gitignore`).

Только после этого переходите к шагам ниже.

## 1. Попросите Cursor изучить репозиторий

Сообщите ассистенту в Cursor, что нужно внимательно прочитать `instructions.md` и весь проект. Этот документ фиксирует стандарты SGR: структуру состояния, требования к сервисам, инструментам и планировщику. До начала разработки убедитесь, что Cursor ответил кратким пересказом ключевых правил.

## 2. Опишите бизнес-задачу и схемы рассуждений

В свободном текстовом сообщении зафиксируйте:
- контекст/клиента, ради которого создаётся агент;
- целевую бизнес-метрику (например, скорость обработки обращений);
- цепочки reasoning-схем: какие шаги должен пройти агент (lookup → валидация → действие → финал), какие данные хранить в состоянии и какие сервисы понадобятся.

Эта информация станет основой для расширения `BaseAgentBusinessState`, сервисов и action-инструментов.

## 3. Попросите Cursor спланировать решение

Когда задача описана, попросите Cursor явно составить план разработки: какие файлы менять, какие схемы добавить, где обновить планировщик. Убедитесь, что план:
- ссылается на конкретные пути (`state.py`, `tools/actions.py`, `tools/planning.py`, `services.py`, `main.py`);
- учитывает ограничения Literals и необходимость тестов (`tests/`).

## 4. Провалидируйте и скорректируйте план

Сравните предложенный план с бизнес-требованиями:
- хватает ли шагов, чтобы покрыть весь сценарий;
- есть ли риски (например, забыли обновить `AVAILABLE_ACTIONS`);
- требуется ли дополнительный планировщик или сервис.

При обнаружении пробелов дайте Cursor уточняющие правки и попросите перепланировать. Повторяйте, пока план не отражает нужный вам пайплайн.

## 5. Навайбкодьте агента

Следуя утверждённому плану:
- Расширьте состояние и сервисный слой.
- Добавьте/обновите action-инструменты и планировщик (Literal с новыми действиями обязателен).
- Зарегистрируйте инструменты в `main.py` и убедитесь, что оркестратор знает о новых схемах.
- Обновите или добавьте тесты: сериализация стейта, инструменты, планировщик, вспомогательные модули.
- Запустите `pytest` из виртуального окружения и убедитесь, что логи в `executions/` формируются корректно.

После завершения попросите Cursor подготовить summary изменений, перечень тестов и рекомендации по деплою.


